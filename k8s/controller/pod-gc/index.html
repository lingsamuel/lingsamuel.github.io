<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=alternate href=https://lingsamuel.github.io/index.xml type=application/rss+xml title="Hakurei Shrine"><link href=https://lingsamuel.github.io/img/favicon.ico rel=icon type=image/x-icon><link rel=stylesheet href=https://lingsamuel.github.io/css/source-serif-text.css><link rel=stylesheet href=https://lingsamuel.github.io/css/fonts.css><link rel=stylesheet href=https://lingsamuel.github.io/css/main.css><link rel=preconnect href=https://fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-89095899-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body id=body><nav id=navbar><div class=nav><div class=navbar-header><img src=https://lingsamuel.github.io/img/favicon.ico class=favicon><a href=https://lingsamuel.github.io/>
Hakurei Shrine</a></div><div class=navbar-menu><ul><li><a title=Articles href=/page>Articles</a></li><li><a title=Reviews href=/review>Reviews</a></li><li><a title=Feeds href=/feed>Feeds</a></li><li><a title=Kubernetes href=/k8s>Kubernetes</a></li><li><a title=About href=/about>About</a></li><li><a title=Categories href=/categories>Categories</a></li><li><a title=Tags href=/tags>Tags</a></li></ul></div></div></nav><div class=flex-container><div class=container id=mainContainer role=main><header class="header post-header"><div class=row><div class=post-title><h1>Pod GC Controller</h1></div><div class=post-meta><span class=author>Ling Samuel</span>
&bull;
<span class=date>2021-03-09</span>
&bull;
<span class=categories><a href=https://lingsamuel.github.io/categories/kubernetes/>kubernetes</a>&nbsp;</span></div></div></header><div class=row><div><article role=main class=blog-post><p>Pod GC Controller 的实现 (<a href=https://github.com/kubernetes/kubernetes/blob/16b909ce1483258464715c9ab76b4dff82d596e5/pkg/controller/podgc/gc_controller.go#L64-L64>src</a>) 较为简单。</p><p>Pod GC Controller 实现三个功能：</p><ul><li>若 <code>TerminatedPodGCThreshold</code> > 0，按创建时间清理 <code>Status.Phase</code> 不是 <code>Pending</code>, <code>Running</code>, <code>Unknown</code> 的 Pod。</li><li>清理所在节点（<code>Spec.NodeName</code>）不再存在的 Pod。<ul><li>这一步不会立刻开始清理。而是会等待一段时间（默认 40 秒），若节点依旧不存在，才会开始清理。</li></ul></li><li>清理删除时间不为空，且没有被调度到某个节点上（<code>Spec.NodeName</code>）的 Pod。<ul><li>若 Pod 已经被调度到了一个节点上，删除事件是<a href=https://github.com/kubernetes/kubernetes/blob/16b909ce1483258464715c9ab76b4dff82d596e5/pkg/kubelet/kubelet.go#L1752-L1752>由 Kubelet 处理</a>的。</li></ul></li></ul><div id=refContainer></div></article></div><div class=post-pager><ul class=pager><li class=previous><a href=https://lingsamuel.github.io/k8s/controller/deployment/>&larr; Deployment Controller 实现</a></li><li class=next><a href=https://lingsamuel.github.io/k8s/controller/replicaset/>ReplicaSet Controller 实现 &rarr;</a></li></ul></div></div></div></div><footer id=footer><div class=footer><p>Copyright © 2021 Ling Samuel &bull; Powered by <a href=https://gohugo.io>Hugo v0.82.0</a> &bull; Theme <a href=https://github.com/lingsamuel/purity>Purity</a> &bull; Hosted by GitHub</p></div></footer></body></html>