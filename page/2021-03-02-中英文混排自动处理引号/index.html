<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>中英文混排：自动处理引号 - Hakurei Shrine</title><link rel=alternate href=https://lingsamuel.github.io/index.xml type=application/rss+xml title="Hakurei Shrine"><link href=https://lingsamuel.github.io/img/favicon.ico rel=icon type=image/x-icon alt=favicon><link rel=stylesheet href=https://lingsamuel.github.io/css/main.min.1402f5c5c6383807c899aa1b78e6e7b88116059e24f89a6f2df3195e70dfa4d6.css integrity="sha256-FAL1xcY4OAfImaobeObnuIEWBZ4k+JpvLfMZXnDfpNY=" media=screen><link rel=stylesheet href=https://lingsamuel.github.io/css/book.min.4b0b8750931e5fac50e9f925eb06212025c38f696da645ae3b37180ebdcce4d3.css integrity="sha256-SwuHUJMeX6xQ6fkl6wYhICXDj2ltpkWuOzcYDr3M5NM=" media=screen><link rel=stylesheet href=https://lingsamuel.github.io/css/source-serif-text.min.c9da0ad693ce3a1c2c04f7a6eb65a3953cb830ab0316c8ba5f230f86aad7b486.css integrity="sha256-ydoK1pPOOhwsBPem62WjlTy4MKsDFsi6XyMPhqrXtIY=" media=screen><link rel=stylesheet href=https://lingsamuel.github.io/css/fonts.min.8c7cdb109cdcfdc41e1509b588ad9330dcf3d8ae8ba96dc5be2e1935aa7c30e2.css integrity="sha256-jHzbEJzc/cQeFQm1iK2TMNzz2K6LqW3Fvi4ZNap8MOI=" media=screen><link rel=preload href=https://lingsamuel.github.io/css/fira-code.min.311370d25700134bbb9a194f401aded40a90707976f08528042a506e5f0306ef.css integrity="sha256-MRNw0lcAE0u7mhlPQBre1AqQcHl28IUoBCpQbl8DBu8=" media=screen as=style onload="this.rel='stylesheet'"><link rel=preload href=https://lingsamuel.github.io/css/math-symbol.min.de044ea9623db3709e697fd61ab5698bf4bac9a737e77b4449579b0a56d70c29.css integrity="sha256-3gROqWI9s3CeaX/WGrVpi/S6yac353tESVebClbXDCk=" media=screen as=style onload="this.rel='stylesheet'"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-89095899-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body id=body><nav id=navbar><div class=nav><div class=navbar-header><img src=https://lingsamuel.github.io/img/favicon.ico class=favicon><a href=https://lingsamuel.github.io/>
Hakurei Shrine</a></div><div class=navbar-menu><ul><li><a title=Articles href=/page>Articles</a></li><li><a title=Reviews href=/review>Reviews</a></li><li><a title=Feeds href=/feed>Feeds</a></li><li><a title=Kubernetes href=/k8s>Kubernetes</a></li><li><a title=About href=/about>About</a></li><li><a title=Categories href=/categories>Categories</a></li><li><a title=Tags href=/tags>Tags</a></li></ul></div></div></nav><div class=flex-container><div class=container id=mainContainer role=main><header class="header post-header"><div class=row><div class=post-title><h1>中英文混排：自动处理引号</h1></div><div class=post-meta><span class=author>Ling Samuel</span>
&bull;
<span class=date>2021-03-02</span>
&bull;
<span class=categories><a href=https://lingsamuel.github.io/categories/programming/>programming</a>&nbsp;
<a href=https://lingsamuel.github.io/categories/writings/>writings</a>&nbsp;</span></div></div></header><div class=row><div><article role=main class=post-content><p>通过内嵌带有 <code>lang</code> 标记的 <code>&lt;span></code> 标签来正确处理中英文混排时的引号字体问题。</p><h2 id=motivation>Motivation</h2><p>现在的字体大多数都有针对 Unicode 开闭引号 <code>‘’“”</code> 有特殊的设计，大多数内容也不再使用 ASCII 引号 <code>"</code>。
同样，<code>Hugo</code> 在解析时也会将 ASCII 引号转化为 Unicode 引号。</p><p>但问题是 Unicode 没有区分中英文引号，而英文字体大多数时候是半个汉字宽，且 <code>font-family</code> 在中文字体前。</p><p>这使得中文里使用英文引号非常痛苦，十分丑陋。</p><p>若是利用 <code>font-face</code> 和 Unicode Range 专门建立一个中文引号字体，如：</p><div class=highlight><pre class=chroma><code class=language-css data-lang=css><span class=p>@</span><span class=k>font-face</span> <span class=p>{</span>
  <span class=nt>font-family</span><span class=o>:</span> <span class=s2>&#34;Chinese Quote&#34;</span><span class=o>;</span>
  <span class=nt>src</span><span class=o>:</span> <span class=nt>local</span><span class=o>(</span><span class=s1>&#39;Source Han Sans CN&#39;</span><span class=o>),</span> <span class=nt>url</span><span class=o>(/</span><span class=nt>fonts</span><span class=o>/</span><span class=nt>SourceHanSansCN-Regular</span><span class=p>.</span><span class=nc>otf</span><span class=o>);</span>
  <span class=nt>unicode-range</span><span class=o>:</span> <span class=nt>U</span><span class=o>+</span><span class=nt>2018</span><span class=o>,</span> <span class=nt>U</span><span class=o>+</span><span class=nt>2019</span><span class=o>,</span> <span class=nt>U</span><span class=o>+</span><span class=nt>201c</span><span class=o>,</span> <span class=nt>U</span><span class=o>+</span><span class=nt>201d</span><span class=o>;</span>
<span class=p>}</span>
</code></pre></div><p>又会导致英文里显示的也是中文引号，更加痛苦了。</p><h2 id=解决方案>解决方案</h2><p>于是我糙快猛地<a href=https://github.com/lingsamuel/ZhEnQuoteSanitizer>写了一个小脚本</a>，类似于解析 <code>code</code> 块一样，将文本解析成中文和英文，然后往源元素下插入解析后的、带有 <code>lang</code> 标记的 <code>&lt;span></code> 标签，再利用 <code>:lang()</code> 选择器使用不同的字体，即可达成混排时也能正确显示引号的效果。</p><p>由于主题的样式和格式比较复杂，目前我只应用在了 header tag 和 <code>p</code> 上。</p><p>实际上这个解决方案并不非常合理。因为混排时英文引号应该仅在整句等处使用，而不是所有英文。</p><p>此外，由于 <code>:lang</code> 伪类优先级高于 <code>class</code>，大概率需要新增很多 CSS 规则。</p><h3 id=引号之神>引号之神</h3><p><a href=https://github.com/lingsamuel/FuHsi.js>FuHsi.js</a></p><h3 id=演示>演示</h3><p>鉴于我的字体设置没有经过完善的测试，可能并不是所有环境都有效的，放一个截图在这。</p><p><img src=/page/quote/quote-sample.png alt></p><h4 id=示例>示例</h4><p>混合“引号”与 &ldquo;Quotes&rdquo;。</p><p>“Mary said,‘It’me.’”，他说。</p><p>“引号”</p><p>“引号”，和英文 “english”</p><p>it’me 的中文含义是什么？</p><p>“引号“mixed””</p><p>不要总是对女孩说“Pretty!”！</p><p>他站在那，感叹了句“What a beautiful scene!”。</p><p>“He is man.”、“He is a man.”和“He is the man”的区别是什么？</p><p>“中文 English English”。</p><p>“English English 中文”。</p><p>中文“中文 English English”。English</p><p>中文“中文 English English”。中文</p><p>English“中文 English English”。中文</p><p>English“中文 English English”。English</p><p>中文“English English”。English</p><p>中文“English English”。中文</p><p>English“English English”。English</p><p>English“English English”。中文</p><hr><h4 id=中文引号>中文“引号”</h4><h4 id=english-quotes>English &ldquo;Quotes&rdquo;</h4><h4 id=混合引号与-quotes>混合“引号”与 &ldquo;Quotes&rdquo;</h4><div id=refContainer></div></article></div><div class=post-pager><ul class=pager><li class=previous><a href=https://lingsamuel.github.io/page/2021-02-23-%E5%A3%B0%E6%98%8E%E5%BC%8F%E9%83%A8%E7%BD%B2/>&larr; “声明式”部署</a></li><li class=next><a href=https://lingsamuel.github.io/page/render-mermaid-without-shortcode/>不使用 Shortcode 渲染 Mermaid 图 &rarr;</a></li></ul></div></div></div><div id=toc><aside><nav id=TableOfContents><ul><li><a href=#motivation>Motivation</a></li><li><a href=#解决方案>解决方案</a><ul><li><a href=#引号之神>引号之神</a></li><li><a href=#演示>演示</a></li></ul></li></ul></nav></aside></div></div><footer id=footer><div class=footer><p>Copyright © 2021 <a href=https://lingsamuel.github.io>Ling Samuel</a> &bull; Powered by <a href=https://gohugo.io>Hugo v0.82.0</a> &bull; Theme <a href=https://github.com/lingsamuel/purity>Purity</a> &bull; Hosted by GitHub</p></div></footer></body></html>